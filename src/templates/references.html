{% extends "layout.html" %}
{% block content %}
  <div class="d-flex justify-content-center">
    <div class="col-8">
      <h1>References
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-server" viewBox="0 0 16 16">
          <path d="M1.333 2.667C1.333 1.194 4.318 0 8 0s6.667 1.194 6.667 2.667V4c0 1.473-2.985 2.667-6.667 2.667S1.333 5.473 1.333 4V2.667z"/>
          <path d="M1.333 6.334v3C1.333 10.805 4.318 12 8 12s6.667-1.194 6.667-2.667V6.334a6.51 6.51 0 0 1-1.458.79C11.81 7.684 9.967 8 8 8c-1.966 0-3.809-.317-5.208-.876a6.508 6.508 0 0 1-1.458-.79z"/>
          <path d="M14.667 11.668a6.51 6.51 0 0 1-1.458.789c-1.4.56-3.242.876-5.21.876-1.966 0-3.809-.316-5.208-.876a6.51 6.51 0 0 1-1.458-.79v1.666C1.333 14.806 4.318 16 8 16s6.667-1.194 6.667-2.667v-1.665z"/>
        </svg>
      </h1>
      <p class="lead">
        Here you can see all currently stored references.
      </p>

        <figure>
          <blockquote class="blockquote">Search
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
            </svg>
          </blockquote>
      
          <form action="/search" method="post">
      
            <div class="form-group text-center">
              <figcaption class="blockquote-footer">
                <label for="input">Search with this form</label>
                <input type="text" class="form-control" id="input_keyword" name="keyword">
              </figcaption>
            </div>
          </figure>

          <div class="form-group text-center">
            <input type="submit" class="btn btn-primary" value="Search">
          </div>
    
        </form>

      <p class="lead">Or choose what references to display</p>
      <form action="/display_references" method="post">

        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="radiobutton" id="all" value="all" checked="checked">
          <label class="form-check-label" for="inlineRadio1">All references</label>
        </div>

        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="radiobutton" id="bibitex" value="bibitext">
          <label class="form-check-label" for="inlineRadio2">BibTeX only</label>
        </div>

        <div class="form-group text-center">
          <input type="submit" class="btn btn-primary" value="Choose type">
        </div>


      </form>
      
      {% if all %}
      {% if books %}

      <h3>Books
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-book" viewBox="0 0 16 16">
          <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"/>
        </svg>
      </h3>
      <ul class="col-12 text-center">
        {% for book in books %}
        <h5>Title: {{ book.title }}</h5>
        <ul>
          <li>Author: {{ book.author }}</li>
          <li>Year: {{ book.year }}</li>
          <li>Publisher: {{ book.publisher }}</li>
          <p>
            Bibitex:
            <pre>{{ book.bibitex }}</pre>
          </p>

        </ul>
        {% endfor %}
      </ul>
      {% endif %}

      
      {% if articles %}
      <h3>Articles
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-text" viewBox="0 0 16 16">
          <path d="M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1H5z"/>
          <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"/>
        </svg>
      </h3>
      <ul class="col-12 text-center">
        {% for article in articles %}
        <h5>Title: {{ article.title }}</h5>
        <ul>
          <li>Author: {{ article.author }}</li>
          <li>Year: {{ article.year }}</li>
          <li>Journal: {{ article.journal }}</li>
          <li>Volume: {{ article.volume }}</li>
          <li>Pages: {{ article.pages }}</li>
          <p>
            Bibitex:
            <pre>{{ article.bibitex }}</pre>
          </p>

        </ul>
        {% endfor %}
      </ul>
      {% endif %}

      {% if in_proceedings %}
      <h3>In proceedings
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-justify-right" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-4-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5zm0-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5zm0-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z"/>
        </svg>
      </h3>
      <ul class="col-12 text-center">
        {% for in_proceeding in in_proceedings %}
        <h5>Title: {{ in_proceeding.title }}</h5>
        <ul>
          <li>Author: {{ in_proceeding.author }}</li>
          <li>Year: {{ in_proceeding.year }}</li>
          <li>Booktitle: {{ in_proceeding.booktitle }}</li>
          <p>
            Bibitex:
            <pre>{{ in_proceeding.bibitex }}</pre>
          </p>

        </ul>
        {% endfor %}
      </ul>
      {% endif %}
      {% endif %}

      {% if bibitex %}
      <div class="form-group text-center">
        <button type="submit" class="btn btn-primary" onclick=copyToClipboard()>
          Copy to clipboard?
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard2-check" viewBox="0 0 16 16">
            <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5h3Z"/>
            <path d="M3 2.5a.5.5 0 0 1 .5-.5H4a.5.5 0 0 0 0-1h-.5A1.5 1.5 0 0 0 2 2.5v12A1.5 1.5 0 0 0 3.5 16h9a1.5 1.5 0 0 0 1.5-1.5v-12A1.5 1.5 0 0 0 12.5 1H12a.5.5 0 0 0 0 1h.5a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5v-12Z"/>
            <path d="M10.854 7.854a.5.5 0 0 0-.708-.708L7.5 9.793 6.354 8.646a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3Z"/>
          </svg>
        </button>
      </div>

      {% if books %}
      <ul class="col-12 text-ceter">
        {% for book in books %}
        <ul class="text-center">
          <pre id="bok-to-copy">{{ book.bibitex }}</pre>
        </ul>
        {% endfor %}
      </ul>
      {% endif %}

      
      {% if articles %}
      <ul class="col-12 text-ceter">
        {% for article in articles %}
        <ul class="text-center">
          <pre id="art-to-copy">{{ article.bibitex }}</pre>
        </ul>
        {% endfor %}
      </ul>
      {% endif %}

      {% if in_proceedings %}
      <ul class="col-12 text-ceter">
        {% for in_proceeding in in_proceedings %}
        <ul class="text-center">
          <pre id="inp-to-copy">{{ in_proceeding.bibitex }}</pre>
        </ul>
        {% endfor %}
      </ul>
      </div>
      {% endif %}
      {% endif %}

      {% with messages = get_flashed_messages() %}
      {% if messages %}
      <ul>
        {% for message in messages %}
        <li>{{ message }}</li>
        {% endfor %}
      </ul>
      {% endif %}
      {% endwith %}
    </div>


    {% with messages = get_flashed_messages() %}
    {% if messages %}
      <ul>
      {% for message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
      </ul>
    {% endif %}
    {% endwith %}
    </div>
  </div>
</div>


  </div>
</div>

<script>
  // author juuso s
  // huomioikaa että tämä ensimmäinen js mitä työstän
  
    function copyToClipboard() {
  
      // näillä if statementeillä koitin väistää tilannetta jossa jokin kenttä puuttuu
      var all = '';
      if (document.getElementById("bok-to-copy") != null)
        var bok = document.getElementById("bok-to-copy").innerText
        var all = all + bok;
      if (document.getElementById("art-to-copy") != null)
        var art = document.getElementById("art-to-copy").innerText
        var all = all + art;
      if (document.getElementById("inp-to-copy") != null)
        var inp = document.getElementById("inp-to-copy").innerText
        var all = all + inp;
  
      var tempTextArea = document.createElement("textarea");
  
      tempTextArea.value = all;
  
      document.body.appendChild(tempTextArea);
  
      tempTextArea.select();
  
      document.execCommand("copy");
  
  
      document.body.removeChild(tempTextArea);
    }
</script>

{% endblock %}